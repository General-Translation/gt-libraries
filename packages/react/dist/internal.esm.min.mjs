import{jsx as e}from"react/jsx-runtime";import r,{isValidElement as n}from"react";import"generaltranslation";const t=e=>`Duplicate key found in dictionary: "${e}"`;function a(e,r=""){const n={};for(const i in e)if(e.hasOwnProperty(i)){const o=r?`${r}.${i}`:i;if("object"!=typeof e[i]||null===e[i]||Array.isArray(e[i])){if(n.hasOwnProperty(o))throw new Error(t(o));n[o]=e[i]}else{const r=a(e[i],o);for(const e in r){if(n.hasOwnProperty(e))throw new Error(t(e));n[e]=r[e]}}}return n}function i(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(t=Object.getOwnPropertySymbols(e);a<t.length;a++)r.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(e,t[a])&&(n[t[a]]=e[t[a]])}return n}"function"==typeof SuppressedError&&SuppressedError;var o="en-US",l=["singular","plural","dual","zero","one","two","few","many","other"];const s=e=>`gt-react: No dictionary entry found for id: "${e}"`;function c(t,a=0){let o=a;const s=e=>{const{type:r,props:n}=e;o+=1;let t,a={id:o};try{t="function"==typeof r&&r.gtTransformation||""}catch(e){t=""}if(t){const r=t.split("-");if("translate"===r[0])throw new Error((e=>{var r;return`General Translation: Nested <T> components. The inner <T> has the id: "${null===(r=null==e?void 0:e.props)||void 0===r?void 0:r.id}".`})(e));if("variable"===r[0]&&(a.variableType=(null==r?void 0:r[1])||"variable"),"plural"===r[0]){const e=Object.entries(n).reduce(((e,[r,n])=>{var t;return t=r,l.includes(t)&&(e[r]=c(n,o)),e}),{});Object.keys(e).length&&(a.branches=e)}if("branch"===r[0]){const e=i(n,["children","branch"]),r=Object.entries(e).reduce(((e,[r,n])=>(e[r]=c(n,o),e)),{});Object.keys(r).length&&(a.branches=r)}a.transformation=r[0]}return a};function u(t){return n(t)?function(n){const{props:t,type:a}=n;if(console.log("TYPE:",a),t["data-_gt"])throw new Error((e=>`General Translation already in use on child with props: ${e.props}. This usually occurs when you nest <T> components within the same file. Remove one of the <T> components to continue.`)(n));let i=s(n),o=Object.assign(Object.assign({},t),{"data-_gt":i});if(t.children&&!i.variableType&&(o.children=d(t.children)),n.type===r.Fragment)return o["data-_gt"].transformation,e("span",Object.assign({style:{all:"unset",display:"contents"}},o));return r.cloneElement(n,o)}(t):t}function d(e){return Array.isArray(e)?r.Children.map(e,u):u(e)}return d(t)}const u={variable:"value",number:"n",datetime:"date",currency:"cost"};function d(e="variable"){return u[e]||"variable"}const p="_gt_";function b(e={},r){var n;if(e.name)return e.name;if(e["data-_gt-variable-name"])return e["data-_gt-variable-name"];return`${p}${u[r]||"value"}_${null===(n=e["data-_gt"])||void 0===n?void 0:n.id}`}const f=e=>{var r;if(!e)return"";const{type:n,props:t}=e;if(n&&"function"==typeof n){if("displayName"in n&&"string"==typeof n.displayName&&n.displayName)return n.displayName;if("name"in n&&"string"==typeof n.name&&n.name)return n.name}return n&&"string"==typeof n?n:t.href?"a":(null===(r=t["data-_gt"])||void 0===r?void 0:r.id)?`C${t["data-_gt"].id}`:"function"},v=e=>{return n=e,r.isValidElement(n)?(e=>{const{type:r,props:n}=e;let t={type:f(e),props:{}};if(n["data-_gt"]){const e=n["data-_gt"];let r=Object.assign({},e);const a=e.transformation;if("variable"===a){const r=e.variableType||"variable";return{variable:r,key:b(n,r),id:e.id}}if("plural"===a&&e.branches){t.type="Plural";let n={};Object.entries(e.branches).forEach((([e,r])=>{n[e]=y(r)})),r=Object.assign(Object.assign({},r),{branches:n})}if("branch"===a&&e.branches){t.type="Branch";let n={};Object.entries(e.branches).forEach((([e,r])=>{n[e]=y(r)})),r=Object.assign(Object.assign({},r),{branches:n})}t.props["data-_gt"]=r}return n.children&&(t.props.children=y(n.children)),t})(e):"number"==typeof e?e.toString():e;var n};function y(e){return Array.isArray(e)?e.map(v):v(e)}function h(e,r,n){let t="",a=null;return"number"==typeof e&&!a&&n&&(t=function(e,r,n){void 0===r&&(r=l),void 0===n&&(n=[o]);var t=new Intl.PluralRules(n).select(e),a=Math.abs(e);if(0===a&&r.includes("zero"))return"zero";if(1===a){if(r.includes("singular"))return"singular";if(r.includes("one"))return"one"}if("one"===t&&r.includes("singular"))return"singular";if(2===a){if(r.includes("dual"))return"dual";if(r.includes("two"))return"two"}return"two"===t&&r.includes("dual")?"dual":r.includes(t)?t:"two"===t&&r.includes("dual")?"dual":"two"===t&&r.includes("plural")?"plural":"two"===t&&r.includes("other")?"other":"few"===t&&r.includes("plural")?"plural":"few"===t&&r.includes("other")?"other":"many"===t&&r.includes("plural")?"plural":"many"===t&&r.includes("other")?"other":"other"===t&&r.includes("plural")?"plural":""}(e,Object.keys(n),r)),t&&!a&&(a=n[t]),a}function g(e){if("string"==typeof e)return!0;if(Array.isArray(e)){if("string"!=typeof(null==e?void 0:e[0]))return!1;const r=null==e?void 0:e[1];if(void 0===r)return!0;if(r&&"object"==typeof r)return!0}return!1}function m(e,n){let t=e,a=n.split(".");for(const e of a){if("object"!=typeof t||Array.isArray(t)||r.isValidElement(t))return void console.error(s(n));t=t[e]}return t}function O(e){if(Array.isArray(e)){if(1===e.length)return{entry:e[0]};if(2===e.length)return{entry:e[0],metadata:e[1]}}return{entry:e}}function j(e){var r;const n=(null===(r=e["data-_gt"])||void 0===r?void 0:r.variableType)||"variable";return{variableType:n,variableName:b(e,n),variableValue:void 0!==e.value?e.value:void 0!==e["data-_gt-unformatted-value"]?e["data-_gt-unformatted-value"]:void 0!==e.children?e.children:void 0,variableOptions:(()=>{const r=Object.assign(Object.assign({},e.currency&&{currency:e.currency}),e.options&&Object.assign({},e.options));return Object.keys(r).length?r:"string"==typeof e["data-_gt-variable-options"]?JSON.parse(e["data-_gt-variable-options"]):e["data-_gt-variable-options"]||void 0})()}}function _(e){const r=e;if(r&&"object"==typeof r&&"string"==typeof r.key){const e=Object.keys(r);if(1===e.length)return!0;if(2===e.length){if("number"==typeof r.id)return!0;if("string"==typeof r.variable)return!0}if(3===e.length&&"string"==typeof r.variable&&"number"==typeof r.id)return!0}return!1}function E(e){return e&&e.props&&e.props["data-_gt"]?e.props["data-_gt"]:null}function w({children:e,variables:n={},variablesOptions:t={},defaultLocale:a=o,renderVariable:l}){const s=e=>r.isValidElement(e)?(e=>{const o=E(e);if("variable"===(null==o?void 0:o.transformation)){let{variableName:r,variableType:i,variableValue:o,variableOptions:s}=j(e.props);return o=(()=>{if(void 0!==n[r])return n[r];if(void 0!==o)return o;if(r.startsWith(p)){const e=d(i);if(void 0!==n[e])return n[e]}})(),s=Object.assign(Object.assign({},t[r]),s),l({variableName:r,variableType:i,variableValue:o,variableOptions:s,locales:[a]})}if("plural"===(null==o?void 0:o.transformation)){const r="number"==typeof n.n?n.n:"number"==typeof e.props.n?e.props.n:e.props["data-_gt-n"];"number"==typeof r&&void 0===n.n&&(n.n=r);const t=o.branches||{};return c(h(r,[a],t)||e.props.children)}if("branch"===(null==o?void 0:o.transformation)){let r=e.props,{children:t,name:a,branch:l,"data-_gt":s}=r,u=i(r,["children","name","branch","data-_gt"]);return a=a||e.props["data-_gt-name"]||"branch",l=n[a]||l||e.props["data-_gt-branch-name"],u=o.branches||{},c(void 0!==u[l]?u[l]:t)}return e.props.children?r.cloneElement(e,Object.assign(Object.assign({},e.props),{"data-_gt":void 0,children:c(e.props.children)})):r.cloneElement(e,Object.assign(Object.assign({},e.props),{"data-_gt":void 0}))})(e):e,c=e=>Array.isArray(e)?r.Children.map(e,s):s(e);return c(e)}function A({sourceElement:e,targetElement:n,variables:t={},variablesOptions:a={},locales:i=[o],renderVariable:l}){var s;const{props:c}=e,u=c["data-_gt"],d=null==u?void 0:u.transformation;if("plural"===d){const r="number"==typeof t.n?t.n:"number"==typeof e.props.n?e.props.n:e.props["data-_gt-n"],o=h(r,i,u.branches||{})||e.props.children,s=h(r,i,n.props["data-_gt"].branches||{})||n.props.children;return"number"==typeof r&&void 0===t.n&&(t.n=r),V({source:o,target:s,variables:t,variablesOptions:a,locales:i,renderVariable:l})}if("branch"===d){let{name:r,branch:o,children:s}=c;r=r||e.props["data-_gt-name"]||"branch",o=t[r]||o||e.props["data-_gt-branch-name"];return V({source:(u.branches||{})[o]||s,target:(n.props["data-_gt"].branches||{})[o]||n.props.children,variables:t,variablesOptions:a,locales:i,renderVariable:l})}return(null==c?void 0:c.children)&&(null===(s=n.props)||void 0===s?void 0:s.children)?r.cloneElement(e,Object.assign(Object.assign({},c),{"data-_gt":void 0,children:V({source:c.children,target:n.props.children,variables:t,variablesOptions:a,locales:i,renderVariable:l})})):w({children:e,variables:t,variablesOptions:a,defaultLocale:i[0],renderVariable:l})}function V({source:n,target:t,variables:a={},variablesOptions:i={},locales:l=[o],renderVariable:s}){if(null==t&&n)return w({children:n,variables:a,variablesOptions:i,defaultLocale:l[0],renderVariable:s});if("string"==typeof t)return t;if(Array.isArray(t)&&!Array.isArray(n)&&n&&(n=[n]),Array.isArray(n)&&Array.isArray(t)){const o=n.filter((e=>{if(r.isValidElement(e)){const r=E(e);if(j(e.props),"variable"!==(null==r?void 0:r.transformation))return!0;{let{variableName:r,variableValue:n,variableOptions:t,variableType:o}=j(e.props);void 0===a[r]&&(a[r]=n);const l=d(o);void 0===a[l]&&(a[l]=n),i[r]=Object.assign(Object.assign({},i[r]),t)}}})),c=e=>o.find((r=>{var n,t;const a=E(r);if(void 0!==(null==a?void 0:a.id)){return a.id===(null===(t=null===(n=null==e?void 0:e.props)||void 0===n?void 0:n["data-_gt"])||void 0===t?void 0:t.id)}return!1}));return t.map(((n,t)=>{if("string"==typeof n)return e(r.Fragment,{children:n},`string_${t}`);if(_(n)){const o=n.key,c=n.variable||"variable",u=(()=>{if(void 0!==a[n.key])return a[n.key];if(o.startsWith(p)){const e=d(c);if(void 0!==a[e])return a[e]}})();return e(r.Fragment,{children:s({variableType:c,variableName:o,variableValue:u,variableOptions:i[n.key],locales:l})},`var_${t}`)}const o=c(n);return o?e(r.Fragment,{children:A({sourceElement:o,targetElement:n,variables:a,variablesOptions:i,locales:l,renderVariable:s})},`element_${t}`):void 0}))}if(t&&"object"==typeof t&&!Array.isArray(t)){const e=_(t)?"variable":"element";if(r.isValidElement(n)){if("element"===e)return A({sourceElement:n,targetElement:t,variables:a,variablesOptions:i,locales:l,renderVariable:s});const r=E(n);if("variable"===(null==r?void 0:r.transformation)){let{variableName:e,variableValue:r,variableOptions:t}=j(n.props);void 0===a[e]&&(a[e]=r),i[e]=Object.assign(Object.assign({},i[e]),t)}}if("variable"===e){const e=t,r=e.key,n=e.variable||"variable",o=(()=>{if(void 0!==a[e.key])return a[e.key];if(r.startsWith(p)){const e=d(n);if(void 0!==a[e])return a[e]}})();return s({variableType:n,variableName:r,variableValue:o,variableOptions:i[e.key]||{},locales:l})}}return w({children:n,variables:a,variablesOptions:i,defaultLocale:l[0],renderVariable:s})}const T={method:"default",timeout:"undefined"!=typeof process&&"development"!==process.env.NODE_ENV?8e3:12e3};function k(){return""}class N extends Error{constructor(e,r){super(e),this.error=e,this.code=r,this.code=r}toTranslationError(){return{state:"error",error:this.error,code:this.code}}}export{N as GTTranslationError,c as addGTIdentifier,T as defaultRenderSettings,a as flattenDictionary,m as getDictionaryEntry,O as getEntryAndMetadata,d as getFallbackVariableName,h as getPluralBranch,b as getVariableName,j as getVariableProps,g as isValidDictionaryEntry,_ as isVariableObject,w as renderDefaultChildren,k as renderSkeleton,V as renderTranslatedChildren,y as writeChildrenAsObjects};
